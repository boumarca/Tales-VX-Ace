#==============================================================================
# ** LMBS_Battle
#------------------------------------------------------------------------------
#  This class performs battle screen processing.
#==============================================================================

module LMBS
  class LMBS_SceneBattle < Scene_Base
    #--------------------------------------------------------------------------
    # * Constant
    #--------------------------------------------------------------------------
    GROUND = 340
    #--------------------------------------------------------------------------
    # * Start Processing
    #--------------------------------------------------------------------------
    def start
      super
      create_viewport
      create_background
      create_battlers
    end
    #--------------------------------------------------------------------------
    # * Post-Start Processing
    #--------------------------------------------------------------------------
    def post_start
      super
    end
    #--------------------------------------------------------------------------
    # * Pre-Termination Processing
    #--------------------------------------------------------------------------
    def pre_terminate
      super
      Graphics.fadeout(30) if SceneManager.scene_is?(Scene_Map)
      Graphics.fadeout(60) if SceneManager.scene_is?(Scene_Title)
    end
    #--------------------------------------------------------------------------
    # * Termination Processing
    #--------------------------------------------------------------------------
    def terminate
      super
      dispose_sprites
      RPG::ME.stop
    end
    #--------------------------------------------------------------------------
    # * Create Viewport
    #--------------------------------------------------------------------------
    def create_viewport
      @viewport = Viewport.new
    end
    #--------------------------------------------------------------------------
    # * Create Background Sprite
    #--------------------------------------------------------------------------
    def create_background
      @background = LMBS_Background.new(@viewport)
    end
    #--------------------------------------------------------------------------
    # * Create Battlers
    #--------------------------------------------------------------------------
    def create_battlers
      @battlers = []
      @battlers.push(LMBS_Battler.new(@viewport, $game_actors[1]))      
    end
    #--------------------------------------------------------------------------
    # * Free Sprites
    #--------------------------------------------------------------------------
    def dispose_sprites
      @background.dispose
      @battlers.each { |battler| battler.dispose }
    end
    #--------------------------------------------------------------------------
    # * Update
    #--------------------------------------------------------------------------
    def update
      super
      update_battlers
    end
    #--------------------------------------------------------------------------
    # * Update Battlers
    #--------------------------------------------------------------------------
    def update_battlers
      @battlers.each { |battler| battler.update }
    end
  end
end
