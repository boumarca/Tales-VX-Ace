#==============================================================================
# ** New Class
# ** Window_RecipeList
#------------------------------------------------------------------------------
#  This window is for choosing which recipe to cook.
#==============================================================================

class Window_RecipeList < Window_Selectable
  #--------------------------------------------------------------------------
  # * Constants (Positions)
  #--------------------------------------------------------------------------
  WINDOW_WIDTH = 256
  #--------------------------------------------------------------------------
  # * Public Instance Variables
  #--------------------------------------------------------------------------
  attr_reader   :ingredient_window
  #--------------------------------------------------------------------------
  # * Object Initialization
  #--------------------------------------------------------------------------
  def initialize(x, y)
    super(x, y, window_width, window_height)
    @data = []
    refresh
  end
  #--------------------------------------------------------------------------
  # * Override
  # * Get Window Width
  #--------------------------------------------------------------------------
  def window_width
    return WINDOW_WIDTH
  end
  #--------------------------------------------------------------------------
  # * Modified
  # * Get Window Height
  #--------------------------------------------------------------------------
  def window_height
    fitting_height(11)
  end
  #--------------------------------------------------------------------------
  # * Set Ingredients Window
  #--------------------------------------------------------------------------
  def ingredient_window=(window)
    @ingredient_window = window
    call_update_help
  end
  #--------------------------------------------------------------------------
  # * Get Number of Items
  #--------------------------------------------------------------------------
  def item_max
    @data ? @data.size : 1
  end
  #--------------------------------------------------------------------------
  # * Override
  # * Draw Item
  #--------------------------------------------------------------------------
  def draw_item(index)
    recipe = @data[index]
    if recipe
      rect = item_rect_for_text(index)
      rect.width -= 4
      draw_recipe_name(recipe, rect)
    end
  end
  #--------------------------------------------------------------------------
  # * Draw Recipe Name
  #--------------------------------------------------------------------------
  def draw_recipe_name(recipe, rect)
    draw_text(rect, recipe.name)
  end
  #--------------------------------------------------------------------------
  # * Get Recipe
  #--------------------------------------------------------------------------
  def recipe
    @data && index >= 0 ? @data[index] : nil
  end
  #--------------------------------------------------------------------------
  # * Override
  # * Update Help Text
  #--------------------------------------------------------------------------
  def update_help
    @help_window.set_item(recipe)
    @ingredient_window.recipe = recipe
  end
  #--------------------------------------------------------------------------
  # * Create Recipe List
  #--------------------------------------------------------------------------
  def make_recipe_list
    @data = $game_cooking.recipes
  end
  #--------------------------------------------------------------------------
  # * Override
  # * Restore Previous Selection Position
  #--------------------------------------------------------------------------
  def select_last
    select($game_cooking.recipes.index($game_cooking.recipe) || 0)
  end
  #--------------------------------------------------------------------------
  # * Override
  # * Refresh
  #--------------------------------------------------------------------------
  def refresh
    make_recipe_list
    super
  end
end